<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>
      CIRED.digital - Assistant documentaire scientifique
    </title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
<style>
table {
    border-collapse: collapse;
    width: 100%;
    margin: 1rem 0;
}
table th, table td {
    border: 1px solid #d1d5db;
    padding: 0.5rem;
    text-align: left;
}
table th {
    background-color: #f9fafb;
    font-weight: 600;
}
</style>

</head>
<body class="bg-gray-50">
<div class="flex flex-col h-screen" id="app">
<!-- Header -->
<div class="bg-white border-b border-gray-200 px-4 py-3 shadow-sm">
<div class="flex items-center justify-between">
<div class="flex items-center space-x-3">
    <button class="px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors" id="config-btn">âš™ï¸</button>
</div>
</div><!-- Configuration Panel -->
<div class="bg-white border-r border-gray-200 p-4 hidden fixed left-0 top-0 h-full w-1/4 overflow-auto" id="config-panel">
    <div class="flex items-center justify-between mb-4">
        <button id="config-close-btn" class="text-gray-500 hover:text-gray-700">âœ–ï¸</button>
        <h2 class="text-lg font-semibold text-gray-900">Cirdi settings</h2>
    </div>
<div class="grid grid-cols-1 gap-4">
<div class="space-y-1">
  <div class="flex items-center justify-between">
    <label class="block text-sm font-medium text-gray-700">
      Server URL
      <span class="ml-1 text-gray-400 cursor-help" title="Where to find the R2R API endpoint. Try http://cired.digital:7272">â„¹ï¸</span>
    </label>
    <div class="text-sm text-gray-500 text-right" id="api-status">Status: OK</div>
  </div>
  <input class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" id="api-url" type="text"/>
</div>
<div>
  <label class="block text-sm font-medium text-gray-700 mb-1">
  Language model
  <span class="ml-1 text-gray-400 cursor-help" title="The LLM used to generate replies. Commercial options disabled for cost control.">â„¹ï¸</span>
  </label>
  <select class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" id="model">
    <option value="ollama/mistral-small:24b-3.1-instruct-2503-q8_0">Mistral small on CNRS servers</option>
    <option value="ollama/mistral-large:latest">Mistral large on CNRS servers</option>
    <option value="ollama/qwen3:32b">Qwen 3 32B on CNRS servers</option>
    <option value="deepseek/deepseek-r1" disabled>Deepseek R1 at Deepseek</option>
    <option value="deepseek/deepseek-chat" disabled>Deepseek chat at Deepseek</option>
    <option value="mistral/open-mistral-7b" disabled>Open mistral 7b at Mistral</option>
    <option value="anthropic/claude-sonnet-4-20250514" disabled>Claude Sonnet 2025-05-14 at Anthropic</option>
    <option value="openai/gpt-4.1-mini" disabled>GPT-4.1 Mini at OpenAI</option>
  </select>
</div>
<div>
  <label class="block text-sm font-medium text-gray-700 mb-1">
  Response variability
  <span class="ml-1 text-gray-400 cursor-help" title="Temperature parameter. Options: 0 / 0.1 / 0.4 / 0.7 / 1.1.">â„¹ï¸</span>
  </label>
  <select class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" id="temperature">
    <option value="0">Repeatable answers</option>
    <option value="0.1" selected>Precise (default)</option>
    <option value="0.4">Analytical</option>
    <option value="0.7">Exploratory</option>
    <option value="1.1">Creative</option>
  </select>
</div>
<div>
  <label class="block text-sm font-medium text-gray-700 mb-1">
    Response length
    <span class="ml-1 text-gray-400 cursor-help" title="Max tokens parameter. Options: 512, 2048, 4096, 8192 (disabled for cost control).">â„¹ï¸</span>
  </label>
  <select class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" id="max-tokens">
    <option value="512">Concise (default)</option>
    <option value="2048">Detailled</option>
    <option value="4096">Long</option>
    <option value="8192" disabled>Oversized</option>
  </select>
</div>
</div>
  <div class="mt-4 flex space-x-4">
    <div class="flex-1 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
      <label class="flex items-center text-sm">
        <input type="checkbox" id="privacy-mode" class="mr-2">
        <span class="text-yellow-800">
          <strong>Privacy Mode</strong> â€“ No conversation logging
        </span>
      </label>
    </div>
  <div class="flex-1 p-3 bg-blue-50 border border-blue-200 rounded-lg">
    <label class="flex items-center text-sm">
      <input type="checkbox" id="debug-mode" class="mr-2">
      <span class="text-blue-800">
        <strong>Debug Mode</strong> â€“ Show response logs in console
      </span>
    </label>
  </div>
  </div>
</div><!-- Messages -->
<div class="flex-1 overflow-y-auto p-4 space-y-4 scroll-smooth" id="messages-container">
<div class="flex justify-start">
<div class="flex max-w-3xl">
<div class="flex-shrink-0 w-8 h-8 rounded-full bg-gray-200 text-gray-600 mr-3 flex items-center justify-center">
<span class="font-bold text-lg">ğŸ¤–</span>
</div>
<div class="flex-1">
<div class="bg-white text-gray-800 border border-gray-200 px-4 py-3 rounded-lg">
<div class="message-content">
Bonjour !<br/>
<br />
Je suis <strong>Cirdi</strong>, votre documentaliste scientifique spÃ©cialisÃ©. Je maÃ®trise les travaux du Centre International de Recherche sur l'Environnement et le DÃ©veloppement (CIRED) et je peux les analyser pour vous proposer des synthÃ¨ses prÃ©cises â€“ avec les liens directs en accÃ¨s libre sur HAL pour en savoir plus ğŸ˜‰.<br />
                <div class="text-center mb-8">
                    <p class="text-sm text-gray-600 italic mt-3 text-center max-w-2xl mx-auto">
                        <strong>Domaines d'expertise</strong> : Cirdi a indexÃ© 1199 publications du CIRED
                    </p>
                    <img alt="Nuage de mots reprÃ©sentant les principales thÃ©matiques de recherche CIRED : changement climatique, transition Ã©nergÃ©tique, politique climatique, modÃ©lisation Ã©conomique, Ã©nergies renouvelables, dÃ©veloppement durable, et politiques environnementales"
                         class="w-full max-w-2xl h-auto max-h-80 object-contain rounded-lg shadow-md mx-auto"
                         src="static/cired_wordcloud.png"/>
                </div>
âš ï¸ <strong>Les conversations sont enregistrÃ©es pour amÃ©liorer le service.</strong><br/>
Vous pourrez donner un feedback en cliquant ğŸ‘ ou ğŸ‘ sous la rÃ©ponse.<br />
ğŸ“Š <a href="#" id="view-analytics-link" class="text-blue-600 hover:text-blue-800">Voir les donnÃ©es collectÃ©es</a> |
ğŸ”’ <a href="#" id="privacy-policy-link" class="text-blue-600 hover:text-blue-800">Politique de confidentialitÃ©</a>
<br />
</div>
</div>
<div class="text-xs text-gray-500 mt-1" id="initial-timestamp"></div>
</div>
</div>
</div>
</div><!-- Error Display -->
<div class="mx-4 mb-2 p-3 bg-red-50 border border-red-200 rounded-lg items-center text-red-800 hidden" id="error-container">
<span class="mr-2">âš ï¸</span> <span class="text-sm" id="error-text"></span>
</div><!-- Input -->
<div class="bg-white border-t border-gray-200 p-4">
<div class="flex space-x-3 max-w-4xl mx-auto">
<div class="flex-1 relative">
<textarea class="w-full px-4 py-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" id="message-input" placeholder="Quelle est votre question sur l'environnement et le dÃ©veloppement?" rows="1" style="min-height: 48px; max-height: 120px;"></textarea>
</div><button class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors" id="send-btn"><span class="font-bold text-lg">â¤</span></button>
</div>
<div class="text-center mt-2">
<div class="text-xs text-gray-500">Cirdi parle franÃ§ais et + de 100 langues: Cirdi speaks English â€“ Hablo espaÃ±ol â€“ Ğ¯ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ñ Ğ¿Ğ¾-Ñ€ÑƒÑÑĞºĞ¸ â€“ æˆ‘ä¼šè¯´ä¸­æ–‡ â€“ Ø£Ù†Ø§ Ø£ØªÙƒÙ„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.</div>
<div class="text-xs text-gray-500">Appuyez sur EntrÃ©e pour envoyer, Maj+EntrÃ©e pour une nouvelle ligne.</div>
</div>
</div>
</div>

<script src="config.js"></script>
<script src="messages.js"></script>
<script src="citations.js"></script>
<script src="tooltips.js"></script>
<script src="api.js"></script>
</body>
</html>
