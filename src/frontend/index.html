<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Cirdi - Assistant documentaire scientifique du CIRED</title>
  <link rel="stylesheet" href="https://unpkg.com/purecss@3.0.0/build/pure-min.css">
  <link rel="stylesheet" href="https://unpkg.com/purecss@3.0.0/build/grids-responsive-min.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  <link rel="stylesheet" href="main.css">
</head>

<body>

<header>
  <button id="config-btn">âš™ï¸</button>
    <div id="input-container">
      <div id="input">
        <textarea
          id="user-input"
          placeholder="Cirdi, que disent les Ã©crits du CIRED sur..."
          rows="2"
          ></textarea>
        <button id="send-btn">
          â¤
        </button>
      </div>
      <div id="input-help">
        <p>Cirdi parle franÃ§ais et + de 100 langues: Cirdi speaks English â€“ Hablo espaÃ±ol â€“ Ğ¯ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ñ Ğ¿Ğ¾-Ñ€ÑƒÑÑĞºĞ¸ â€“ æˆ‘ä¼šè¯´ä¸­æ–‡ â€“ Ø£Ù†Ø§ Ø£ØªÙƒÙ„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.</p>
        <p>Appuyez sur EntrÃ©e pour envoyer, Maj+EntrÃ©e pour une nouvelle ligne.</p>
      </div>
    </div> <!-- id="input-container" -->
</header>

<main id="messages-container">
  <div>
    <div id="greeting">
      Bonjour !<br /><br />
      Je suis <strong>Cirdi</strong>, votre documentaliste scientifique. Je dispose des travaux du Centre International de Recherche sur l'Environnement et le DÃ©veloppement (CIRED) sur les thÃ¨mes ci dessous. Je vais les analyser afin de vous proposer une synthÃ¨se avec liens directs en accÃ¨s libre sur HAL pour en savoir plus ğŸ˜‰.<br />
      <div id="legend">
        <strong>Domaines d'expertise</strong> : Cirdi a indexÃ© 1199 publications du CIRED
      </div>
      <img
        alt="Nuage de mots reprÃ©sentant les principales thÃ©matiques de recherche CIRED : changement climatique, transition Ã©nergÃ©tique, politique climatique, modÃ©lisation Ã©conomique, Ã©nergies renouvelables, dÃ©veloppement durable, et politiques environnementales"
        src="static/cired_wordcloud.png"
      />
    </div> <!-- id="greeting" -->
  </div> <!-- id="messages-container" -->
</main>

<footer>
    âš ï¸ <strong>Les conversations sont enregistrÃ©es pour amÃ©liorer le service.</strong>
    Vous pourrez donner un feedback en cliquant ğŸ‘ ou ğŸ‘ sous la rÃ©ponse.<br />
    ğŸ“Š <a href="#" id="view-analytics-link">Voir les donnÃ©es collectÃ©es</a> |
    ğŸ”’ <a href="#" id="privacy-policy-link">Politique de confidentialitÃ©</a>
</footer>


<!-- Aide button (initially hidden) -->
<button id="aide-btn" class="hidden">Aide</button>

<!-- Mode d'emploi Modal -->
<aside id="mode-emploi-panel">
  <div id="mode-emploi-header">
    <button id="mode-emploi-close-btn">âœ–ï¸</button>
    <h2>Mode d'emploi</h2>
  </div>
  <div id="mode-emploi-content">
    <section>
      <h3>Comment utiliser (comme un moteur de recherche : tapez dans la boÃ®te puis EntrÃ©e)</h3>
      
      <h4>Exemples de questions :</h4>
      <ul>
        <li><strong>"Quelle est la production alimentaire agricole par habitant en Andhra Prades actuellement ?"</strong> illustre la rÃ©cupÃ©ration prÃ©cise de faits avec orthographe approximative (Pradesh manque le h final). Utile pour l'Ã©criture et la recherche, avec une probabilitÃ© plus faible.</li>
        <li><strong>"Le CCS"</strong></li>
        <li>Une question en portugais pour illustrer les capacitÃ©s multilingues.</li>
        <li><strong>"Pourquoi l'Ã©chec de Kyoto?"</strong> illustre la conscience du contexte et la spÃ©cificitÃ© du point de vue CIRED.</li>
        <li><strong>"Comment prÃ©parer ma prÃ©sentation?"</strong> il y a quelques manuels de mÃ©thodes de recherche dans HAL</li>
        <li><strong>"Traduit: Â« De los diversos instrumentos inventados por el hombre, el mÃ¡s asombroso es el libro; todos los demÃ¡s son extensiones de su cuerpo. SÃ³lo el libro es una extensiÃ³n de la imaginaciÃ³n y la memoria. Â» (Borges, 1978)"</strong> c'est un LLM</li>
        <li><strong>"Who is Ignacy Sachs?"</strong> Vous pouvez obtenir la courte biographie des auteurs.</li>
      </ul>
    </section>

    <section>
      <h3>Comment Ã§a marche</h3>
      <p>Une explication de style bande dessinÃ©e, avec Cirdi personnalisÃ© comme assistant :</p>
      
      <div class="comic-explanation">
        <div class="comic-step">
          <strong>ğŸ“š Intake :</strong> lire le corpus, diviser en segments de taille paragraphe et indexer les segments. Cirdi organisant les archives avant d'ouvrir boutique.
        </div>
        
        <div class="comic-step">
          <strong>ğŸ¤” Cirdi recevant une demande d'un visiteur.</strong>
        </div>
        
        <div class="comic-step">
          <strong>ğŸ” Retrieve :</strong> trouver les segments les plus pertinents pour la question. Cirdi dans les archives, trouvant des papiers dans des boÃ®tes.
        </div>
        
        <div class="comic-step">
          <strong>âœï¸ Generate :</strong> Demander Ã  un LLM de rÃ©pondre Ã  la question avec les segments pertinents. Cirdi donnant la pile de papiers Ã  un Ã©crivain. Cirdi rÃ©cupÃ©rant la rÃ©ponse.
        </div>
        
        <div class="comic-step">
          <strong>ğŸ“ Reformat :</strong> prÃ©senter comme un texte acadÃ©mique. Cirdi Ã  son bureau, rÃ©Ã©crivant la rÃ©ponse. Cirdi la retournant Ã  l'utilisateur.
        </div>
      </div>
    </section>

    <section>
      <h3>Limites du corpus</h3>
      <ul>
        <li>De nombreuses publications CIRED ne sont pas archivÃ©es en accÃ¨s libre dans HAL (et Cirdi n'a pas cherchÃ© ailleurs pour le texte intÃ©gral).</li>
        <li>La plupart des anciennes publications CiRED ne sont pas dans Hal (encore ?)</li>
        <li>Quelques publications ne sont pas ingÃ©rÃ©es pour des raisons techniques (environ 1% de fichiers surdimensionnÃ©s)</li>
        <li>Hal archive la production scientifique, pas la communication institutionnelle (par exemple, utilisez le site web CIRED â†’ <a href="https://www.centre-cired.fr" target="_blank">https://www.centre-cired.fr</a> pour connaÃ®tre la recherche en cours, abonnez-vous Ã  la newsletter pour connaÃ®tre les Ã©vÃ©nements actuels â†’ <a href="https://tinyurl.com/z4sr8p6z" target="_blank">https://tinyurl.com/z4sr8p6z</a>).</li>
      </ul>
    </section>

    <section>
      <h3>Limites du systÃ¨me</h3>
      <ul>
        <li>Le LLM peut encore halluciner (Attention aux dÃ©clarations attribuÃ©es Ã  des sources non trouvÃ©es.)</li>
        <li>Pas conversationnel (Cirdi ne se souvient pas des questions prÃ©cÃ©dentes)</li>
        <li>Pas agentique (Cirdi ne stratÃ©gisera pas un plan en plusieurs Ã©tapes qui utilise des outils en ligne pour rÃ©pondre Ã  la question)</li>
        <li>En particulier, Cirdi ne recherche pas dans toute la littÃ©rature scientifique ou autre chose (il existe de nombreux outils pour la revue gÃ©nÃ©rale de littÃ©rature â†’ <a href="https://www.google.com/search?q=Tools+conduct+scientific+literature+review" target="_blank">https://www.google.com/search?q=Tools+conduct+scientific+literature+review</a>)</li>
        <li>Pas persistant (Coupez et collez la rÃ©ponse ailleurs avant de fermer la session.)</li>
        <li>La rÃ©colte de HAL est Ã  la demande, pas pÃ©riodique.</li>
      </ul>
    </section>
  </div>
</aside>

<!-- Configuration Panel -->
<aside class="hidden" id="config-panel"></aside>

  <div id="config-header">
    <button id="config-close-btn">âœ–ï¸</button>
    <h2>Cirdi settings</h2>
  </div>

  <div class="settings-grid" id="settings-container">

    <div class="form-group">
      <div class="label-with-status">
        <label class="form-label">
          Server URL
          <span class="help-icon" title="Where to find the R2R API endpoint. Try http://cired.digital:7272">â„¹ï¸</span>
        </label>
        <div class="status-text" id="api-status">Status: OK</div>
      </div>
      <input class="form-input" id="api-url" type="text"/>
    </div>

    <div class="form-group">
      <label class="form-label">
      Language model
      <span class="help-icon" title="The LLM used to generate replies. Commercial options disabled for cost control.">â„¹ï¸</span>
      </label>
      <select class="form-select" id="model">
        <option>Chargement...</option>
      </select>
      <div id="model-info">
        Tariff: input <span id="input-tariff">...</span>&nbsp;$, output <span id="output-tariff">...</span>&nbsp;$ per 1M tokens
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">
        Temperature (response creativity)
        <span class="help-icon" title="Automatically set to model provider's recommendations.">â„¹ï¸</span>
      </label>
      <input type="number" id="temperature" class="form-input" step="0.05"/>
    </div>

    <div class="form-group">
      <label class="form-label">
        Max tokens (response length)
        <span class="help-icon" title="Automatically set according to the model.">â„¹ï¸</span>
      </label>
      <input type="number" id="max-tokens" class="form-input" step="100"/>
    </div>

    <div class="form-group">
      <label class="form-label">
        Nombre maximum de segments Ã  rÃ©cupÃ©rer
        <span class="help-icon" title="Entre 1 et 1000.">â„¹ï¸</span>
      </label>
      <input type="number" id="chunk-limit" class="form-input" step="1"/>
    </div>

    <div class="form-group">
      <label class="form-label">
        MÃ©thode pour pÃªcher les segments
        <span class="help-icon" title="Options: vanilla (recherche directe rapide - pour question prÃ©cise), rag_fusion (reformule - pour question ambigÃ¼e), HyDE (prÃªche le faux pour pÃªcher le vrai - pour question ouverte, conceptuelle)">â„¹ï¸</span>
      </label>
      <select id="search-strategy" class="form-select">
        <option value="vanilla">Vanilla</option>
        <option value="rag_fusion">RAG Fusion</option>
        <option value="hyde" selected>Hyde</option>
      </select>
    </div>

    <div class="checkbox-container web-search-container">
      <label class="checkbox-label">
        <input type="checkbox" id="include-web-search" class="checkbox-input"  disabled>
        <span class="web-search-text"><strong>Recherche Web</strong> â€“ Inclure les rÃ©sultats web (0.1 cent par question)</span>
      </label>
    </div>

    <div class="checkbox-container privacy-container">
      <label class="checkbox-label">
        <input type="checkbox" id="privacy-mode" class="checkbox-input">
        <span class="privacy-text"><strong>Privacy Mode</strong> â€“ No logging</span>
      </label>
      <div class="form-group">
        <div class="label-with-status">
          <label class="form-label" for="feedback-url">URL du backend de journalisation</label>
          <div class="status-text" id="feedback-status">Chargementâ€¦</div>
        </div>
        <input class="form-input" id="feedback-url" type="text" readonly/>
      </div>
    </div>

    <div class="checkbox-container debug-container">
      <label class="checkbox-label">
        <input type="checkbox" id="debug-mode" class="checkbox-input">
        <span class="debug-text"><strong>Debug Mode</strong> â€“ Show response logs in console</span>
      </label>
    </div>

  </div> <!-- id="settings-container"-->
</aside>


<script src="utils.js"></script>
<script src="settings.js"></script>
<script src="config.js"></script>
<script src="messages.js"></script>
<script src="economics.js"></script>
<script src="citations.js"></script>
<script src="tooltips.js"></script>
<script src="api.js"></script>
</body>
</html>
