<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Cirdi - Assistant documentaire scientifique du CIRED</title>
  <link rel="stylesheet" href="https://unpkg.com/purecss@3.0.0/build/pure-min.css">
  <link rel="stylesheet" href="https://unpkg.com/purecss@3.0.0/build/grids-responsive-min.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  <link rel="stylesheet" href="main.css">
</head>

<body>

<header>
  <button id="config-btn">‚öôÔ∏è</button>
  <button id="profile-btn">üë§</button>
    <div id="input-container">
      <div id="input">
        <textarea
          id="user-input"
          placeholder="Cirdi, que disent les √©crits du CIRED sur..."
          rows="2"
          ></textarea>
        <button id="send-btn">
          ‚û§
        </button>
      </div>
      <div id="input-help">
        <p>Cirdi parle fran√ßais et + de 100 langues: Cirdi speaks English ‚Äì Hablo espa√±ol ‚Äì –Ø –≥–æ–≤–æ—Ä—é –ø–æ-—Ä—É—Å—Å–∫–∏ ‚Äì Êàë‰ºöËØ¥‰∏≠Êñá ‚Äì ÿ£ŸÜÿß ÿ£ÿ™ŸÉŸÑŸÖ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©.</p>
        <p>Appuyez sur Entr√©e pour envoyer, Maj+Entr√©e pour une nouvelle ligne.</p>
      </div>
    </div> <!-- id="input-container" -->
</header>

<main id="messages-container">
  <div>
    <div id="greeting">
      Bonjour !<br /><br />
      Je suis <strong>Cirdi</strong>, votre documentaliste scientifique. Je dispose des travaux du Centre International de Recherche sur l'Environnement et le D√©veloppement (CIRED) sur les th√®mes ci dessous. Je vais les analyser afin de vous proposer une synth√®se avec liens directs en acc√®s libre sur HAL pour en savoir plus üòâ.<br />
      <div id="legend">
        <strong>Domaines d'expertise</strong> : Cirdi a index√© 1199 publications du CIRED
      </div>
      <img
        alt="Nuage de mots repr√©sentant les principales th√©matiques de recherche CIRED : changement climatique, transition √©nerg√©tique, politique climatique, mod√©lisation √©conomique, √©nergies renouvelables, d√©veloppement durable, et politiques environnementales"
        src="static/cired_wordcloud.png"
      />
    </div> <!-- id="greeting" -->
  </div> <!-- id="messages-container" -->
</main>

<footer>
    ‚ö†Ô∏è <strong>Les conversations sont enregistr√©es pour am√©liorer le service.</strong>
    Vous pourrez donner un feedback en cliquant üëç ou üëé sous la r√©ponse.<br />
    üìä <a href="#" id="view-analytics-link">Voir les donn√©es collect√©es</a> |
    üîí <a href="#" id="privacy-policy-link">Politique de confidentialit√©</a>
</footer>


<!-- Configuration Panel -->
<aside class="hidden" id="config-panel">

  <div id="config-header">
    <button id="config-close-btn">‚úñÔ∏è</button>
    <h2>Cirdi settings</h2>
  </div>

  <div class="settings-grid" id="settings-container">

    <div class="form-group">
      <div class="label-with-status">
        <label class="form-label">
          Server URL
          <span class="help-icon" title="Where to find the R2R API endpoint. Try http://cired.digital:7272">‚ÑπÔ∏è</span>
        </label>
        <div class="status-text" id="api-status">Status: OK</div>
      </div>
      <input class="form-input" id="api-url" type="text"/>
    </div>

    <div class="form-group">
      <label class="form-label">
      Language model
      <span class="help-icon" title="The LLM used to generate replies. Commercial options disabled for cost control.">‚ÑπÔ∏è</span>
      </label>
      <select class="form-select" id="model">
        <option>Chargement...</option>
      </select>
      <div id="model-info">
        Tariff: input <span id="input-tariff">...</span>&nbsp;$, output <span id="output-tariff">...</span>&nbsp;$ per 1M tokens
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">
        Temperature (response creativity)
        <span class="help-icon" title="Automatically set to model provider's recommendations.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" id="temperature" class="form-input" step="0.05"/>
    </div>

    <div class="form-group">
      <label class="form-label">
        Max tokens (response length)
        <span class="help-icon" title="Automatically set according to the model.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" id="max-tokens" class="form-input" step="100"/>
    </div>

    <div class="form-group">
      <label class="form-label">
        Nombre maximum de segments √† r√©cup√©rer
        <span class="help-icon" title="Entre 1 et 1000.">‚ÑπÔ∏è</span>
      </label>
      <input type="number" id="chunk-limit" class="form-input" step="1"/>
    </div>

    <div class="form-group">
      <label class="form-label">
        M√©thode pour p√™cher les segments
        <span class="help-icon" title="Options: vanilla (recherche directe rapide - pour question pr√©cise), rag_fusion (reformule - pour question ambig√ºe), HyDE (pr√™che le faux pour p√™cher le vrai - pour question ouverte, conceptuelle)">‚ÑπÔ∏è</span>
      </label>
      <select id="search-strategy" class="form-select">
        <option value="vanilla">Vanilla</option>
        <option value="rag_fusion">RAG Fusion</option>
        <option value="hyde" selected>Hyde</option>
      </select>
    </div>

    <div class="checkbox-container web-search-container">
      <label class="checkbox-label">
        <input type="checkbox" id="include-web-search" class="checkbox-input"  disabled>
        <span class="web-search-text"><strong>Recherche Web</strong> ‚Äì Inclure les r√©sultats web (0.1 cent par question)</span>
      </label>
    </div>

    <div class="checkbox-container privacy-container">
      <label class="checkbox-label">
        <input type="checkbox" id="privacy-mode" class="checkbox-input">
        <span class="privacy-text"><strong>Privacy Mode</strong> ‚Äì No logging</span>
      </label>
      <div class="form-group">
        <div class="label-with-status">
          <label class="form-label" for="feedback-url">URL du backend de journalisation</label>
          <div class="status-text" id="feedback-status">Chargement‚Ä¶</div>
        </div>
        <input class="form-input" id="feedback-url" type="text" readonly/>
      </div>
    </div>

    <div class="checkbox-container debug-container">
      <label class="checkbox-label">
        <input type="checkbox" id="debug-mode" class="checkbox-input">
        <span class="debug-text"><strong>Debug Mode</strong> ‚Äì Show response logs in console</span>
      </label>
    </div>

  </div> <!-- id="settings-container"-->
</aside>

<!-- Onboarding Modal -->
<div id="onboarding-modal" class="modal-overlay hidden">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Bienvenue sur Cirdi !</h2>
      <p>Aidez-nous √† mieux comprendre vos besoins en compl√©tant ce profil rapide.</p>
    </div>
    
    <form id="profile-form" class="settings-grid">
      <div class="form-group">
        <label class="form-label" for="profile-name">Nom (optionnel)</label>
        <input type="text" id="profile-name" class="form-input" placeholder="Votre nom">
      </div>
      
      <div class="form-group">
        <label class="form-label" for="profile-email">Email (optionnel)</label>
        <input type="email" id="profile-email" class="form-input" placeholder="votre.email@exemple.com">
      </div>
      
      <div class="form-group">
        <label class="form-label" for="profile-role">Votre r√¥le</label>
        <select id="profile-role" class="form-select">
          <option value="">S√©lectionnez votre r√¥le</option>
          <option value="researcher">Chercheur/Chercheuse</option>
          <option value="student">√âtudiant(e)</option>
          <option value="policy-maker">D√©cideur politique</option>
          <option value="consultant">Consultant(e)</option>
          <option value="journalist">Journaliste</option>
          <option value="citizen">Citoyen(ne)</option>
          <option value="other">Autre</option>
        </select>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="profile-usage">Contexte d'utilisation</label>
        <select id="profile-usage" class="form-select">
          <option value="">S√©lectionnez le contexte</option>
          <option value="research">Recherche acad√©mique</option>
          <option value="education">Enseignement/Formation</option>
          <option value="policy">√âlaboration de politiques</option>
          <option value="business">Conseil/Business</option>
          <option value="personal">Int√©r√™t personnel</option>
          <option value="journalism">Journalisme</option>
          <option value="other">Autre</option>
        </select>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="profile-organization">Type d'organisation</label>
        <select id="profile-organization" class="form-select">
          <option value="">S√©lectionnez le type</option>
          <option value="university">Universit√©/√âcole</option>
          <option value="research-institute">Institut de recherche</option>
          <option value="government">Administration publique</option>
          <option value="ngo">ONG/Association</option>
          <option value="private-company">Entreprise priv√©e</option>
          <option value="consulting">Cabinet de conseil</option>
          <option value="media">M√©dia</option>
          <option value="individual">Particulier</option>
          <option value="other">Autre</option>
        </select>
      </div>
    </form>
    
    <div class="privacy-notice">
      <p><strong>Confidentialit√© :</strong> Ces informations sont stock√©es uniquement sur cet ordinateur et nous aident √† am√©liorer le service. Vous pouvez les modifier ou les supprimer √† tout moment via le panneau de profil.</p>
    </div>
    
    <div class="modal-actions">
      <button type="button" id="skip-profile" class="secondary-button">Passer</button>
      <button type="button" id="submit-profile" class="primary-button">Enregistrer</button>
    </div>
  </div>
</div>

<!-- Profile Panel -->
<aside class="hidden" id="profile-panel">
  <div id="profile-header">
    <button id="profile-close-btn">‚úñÔ∏è</button>
    <h2>Mon Profil</h2>
  </div>
  
  <div class="settings-grid" id="profile-container">
    <div class="profile-info">
      <p>Profil sp√©cifique √† cet ordinateur</p>
    </div>
    
    <form id="profile-edit-form" class="settings-grid">
      <div class="form-group">
        <label class="form-label" for="edit-profile-name">Nom</label>
        <input type="text" id="edit-profile-name" class="form-input">
      </div>
      
      <div class="form-group">
        <label class="form-label" for="edit-profile-email">Email</label>
        <input type="email" id="edit-profile-email" class="form-input">
      </div>
      
      <div class="form-group">
        <label class="form-label" for="edit-profile-role">R√¥le</label>
        <select id="edit-profile-role" class="form-select">
          <option value="">S√©lectionnez votre r√¥le</option>
          <option value="researcher">Chercheur/Chercheuse</option>
          <option value="student">√âtudiant(e)</option>
          <option value="policy-maker">D√©cideur politique</option>
          <option value="consultant">Consultant(e)</option>
          <option value="journalist">Journaliste</option>
          <option value="citizen">Citoyen(ne)</option>
          <option value="other">Autre</option>
        </select>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="edit-profile-usage">Contexte d'utilisation</label>
        <select id="edit-profile-usage" class="form-select">
          <option value="">S√©lectionnez le contexte</option>
          <option value="research">Recherche acad√©mique</option>
          <option value="education">Enseignement/Formation</option>
          <option value="policy">√âlaboration de politiques</option>
          <option value="business">Conseil/Business</option>
          <option value="personal">Int√©r√™t personnel</option>
          <option value="journalism">Journalisme</option>
          <option value="other">Autre</option>
        </select>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="edit-profile-organization">Type d'organisation</label>
        <select id="edit-profile-organization" class="form-select">
          <option value="">S√©lectionnez le type</option>
          <option value="university">Universit√©/√âcole</option>
          <option value="research-institute">Institut de recherche</option>
          <option value="government">Administration publique</option>
          <option value="ngo">ONG/Association</option>
          <option value="private-company">Entreprise priv√©e</option>
          <option value="consulting">Cabinet de conseil</option>
          <option value="media">M√©dia</option>
          <option value="individual">Particulier</option>
          <option value="other">Autre</option>
        </select>
      </div>
    </form>
    
    <div class="profile-actions">
      <button type="button" id="save-profile" class="primary-button">Sauvegarder</button>
      <button type="button" id="clear-profile" class="secondary-button">Effacer le profil</button>
    </div>
  </div>
</aside>


<script src="utils.js"></script>
<script src="profile.js"></script>
<script src="settings.js"></script>
<script src="config.js"></script>
<script src="messages.js"></script>
<script src="economics.js"></script>
<script src="citations.js"></script>
<script src="tooltips.js"></script>
<script src="api.js"></script>
</body>
</html>
